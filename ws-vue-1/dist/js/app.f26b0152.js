(function(e){function t(t){for(var a,i,c=t[0],o=t[1],l=t[2],d=0,h=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&h.push(n[i][0]),n[i]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);u&&u(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,c=1;c<s.length;c++){var o=s[c];0!==n[o]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=s[0]))}return e}var a={},n={app:0},r=[];function i(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=a,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=o;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"56d7":function(e,t,s){"use strict";s.r(t);s("4de4"),s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.ready?s("div",{attrs:{id:"app"}},[e.errorGlobal?s("div",[s("span",[e._v("Для указанного серийного номера отсутствуют данные SmetaWIZARD 5")])]):s("div",[s("Progressbar",{attrs:{archive:e.archive}}),s("Links",{attrs:{taskCreated:e.taskCreated,archive:e.archive,getLinks:e.getLinks,getArchives:e.getArchives}}),s("tabControls",{on:{"tab-active":e.tabActive,"tab-change":e.tabChange}}),e.tabBaseIsActive?s("appTable",{ref:"appTable",attrs:{checkboxIds:e.checkboxIds,taskCreated:e.taskCreated,archive:e.archive,errorTextLimit:e.errorTextLimit,getLinks:e.getLinks,emptyError:e.emptyError,emptyTasks:e.emptyTasks,checkboxAllEl:e.checkboxAllEl},on:{"select-all":e.checkboxSelectAll,"select-checkbox":e.checkboxCheck,"create-task":e.createTasks,"select-count":e.changeSelectCount}}):s("appTableModule",{attrs:{archive:e.archive,distributionId:e.distributionId,errorTextLimit:e.errorTextLimit,getLinks:e.getLinks,emptyError:e.emptyError,emptyTasks:e.emptyTasks,panel:e.panel,taskCreated:e.taskCreated},on:{"change-distribution":e.setDistributionId,"select-checkbox":e.checkboxCheck,"create-license-archive":e.createLicenseTask,"select-all":e.checkboxSelectAll,"select-count":e.changeSelectCount,"change-panel":e.changePanel}})],1)]):e._e()},r=[],i=(s("c740"),s("4160"),s("caad"),s("d81d"),s("a434"),s("2532"),s("9911"),s("159b"),s("96cf"),s("1da1")),c=s("5530"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{attrs:{id:"app-table-module"}},[s("div",{staticClass:"baseTableLimit__select",on:{click:function(e){e.stopPropagation()}}},[s("selectCount",{on:{"select-count":e.changeSelectCount}})],1),s("v-expansion-panels",e._l(e.pages[e.offset],(function(t,a){return s("v-expansion-panel",{key:t.id,ref:"expPanel",refInFor:!0,attrs:{"data-id":t.id},on:{click:e.changePanel}},[s("v-expansion-panel-header",[s("span",{staticClass:"panel-header-title"},[e._v(e._s(t.name))])]),s("v-expansion-panel-content",[s("selectDistribution",{attrs:{item:t,taskCreated:e.taskCreated,selected:e.panel.distSelected,panels:e.panels,panelId:e.panelId},on:{"change-distribution":e.changeDistributionSelect}}),e.panels.length&&e.panels[a].distSelected?s("tableLicenses",{attrs:{item:t,loading:e.loading},on:{"checkbox-all":e.selectAll,"select-checkbox":e.selectCheckbox}}):e._e()],1)],1)})),1),s("div",{staticClass:"but__wrapper"},[s("div",{staticClass:"but-download__info"},[s("button",{staticClass:"but_download",attrs:{disabled:e.archive.progress<100||e.getLinks.length>=5||!e.panel.distSelected},on:{click:function(t){return e.$emit("create-license-archive")}}},[e._v(" Скачать выделенное ")]),e.archive.progress<100?s("span",{staticClass:"but-download__message"},[e._v(" Вы сможете повторить операцию, после загрузки текущего пакета ")]):e.getLinks.length>=5?s("span",{staticClass:"but-download__message"},[e._v(" "+e._s(e.errorTextLimit)+" ")]):e.emptyTasks?s("span",{staticClass:"but-download__message"},[e._v(" "+e._s(e.emptyError)+" ")]):e._e()]),s("div",{staticClass:"but__controlls"},[s("button",{staticClass:"but_default_bg",staticStyle:{"margin-right":"20px"},attrs:{disabled:!this.canPrev},on:{click:e.prev}},[e._v(" Предыдущая ")]),s("button",{staticClass:"but_default_bg",attrs:{disabled:!this.canNext},on:{click:e.next}},[e._v(" Следующая ")])])])],1)])},l=[],u=(s("fb6a"),s("2f62")),d=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},h=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"lds-spinner"},[s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div")])}],p=s("2877"),f={},b=Object(p["a"])(f,d,h,!1,null,null,null),v=b.exports,g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",{attrs:{id:"moduleTable","data-id":e.item.id}},[s("thead",[s("tr",[s("th",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"selected"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.selected)?e._i(e.selected,null)>-1:e.selected},on:{change:[function(t){var s=e.selected,a=t.target,n=!!a.checked;if(Array.isArray(s)){var r=null,i=e._i(s,r);a.checked?i<0&&(e.selected=s.concat([r])):i>-1&&(e.selected=s.slice(0,i).concat(s.slice(i+1)))}else e.selected=n},function(t){return e.$emit("checkbox-all",t,e.checkboxes)}]}})]),s("th",[e._v("Наименование")]),s("th",[e._v("Дата выгрузки")]),s("th",[e._v("Размер")])])]),e.loading?s("tr",[s("td",{staticClass:"preloader-wrapper",attrs:{colspan:"7"}},[s("preloader")],1)]):s("tbody",e._l(e.item.modules_licenses,(function(t){return s("tr",{key:t.id},[s("td",[s("input",{ref:"checkbox",refInFor:!0,attrs:{type:"checkbox"},domProps:{value:t.id},on:{change:function(t){return e.$emit("select-checkbox",t)}}})]),s("td",[e._v(e._s(t.name))]),s("td",[e._v(e._s(e._f("date")(t.updated_at,"datetime")))]),s("td",[e._v(e._s(t.size))])])})),0)])},k=[],m={data:function(){return{checkboxes:[],selected:!1}},props:["item","loading"],mounted:function(){this.checkboxes=this.$refs.checkbox}},x=m,_=Object(p["a"])(x,g,k,!1,null,null,null),C=_.exports,w={resetCheckbox:function(e){e.forEach((function(e){return e.checked=!1}))},resetCheckboxAll:function(e){e&&(e.checked=!1)},sortedByDesc:function(e,t){return t.updatedate-e.updatedate},sortedByAsc:function(e,t){return e.updatedate-t.updatedate}},y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"select-wrap",on:{click:function(e){e.stopPropagation()}}},[s("span",{staticClass:"select-label"},[e._v("Показывать записей")]),s("div",{staticClass:"select-group"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.limit,expression:"limit"}],staticClass:"custom-select",on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.limit=t.target.multiple?s:s[0]},function(t){e.$emit("select-count",e.changeSelect())}]}},e._l(e.counts,(function(t){return s("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0)])])},A=[],I={data:function(){return{limit:10,counts:[10,25,50,100],labelView:!0,selectedValue:!1}},methods:{changeSelect:function(){return this.labelView=!1,this.selectedValue=!0,{limit:this.limit,labelView:this.labelView,selectedValue:this.selectedValue}}}},j=I,P=Object(p["a"])(j,y,A,!1,null,null,null),T=P.exports,O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("select",{directives:[{name:"model",rawName:"v-model",value:e.distributionId,expression:"distributionId"}],ref:"select-distribution",attrs:{"data-id":e.item.id,id:"selectDistribution"},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.distributionId=t.target.multiple?s:s[0]},function(t){return e.$emit("change-distribution",e.distributionId)}]}},[s("option",{attrs:{disabled:""},domProps:{value:(e.selected,null)}},[e._v("Выберите дистрибутив")]),s("option",{attrs:{value:"not download"}},[e._v("Не скачивать дистрибутив")]),e._l(e.item.distribution,(function(t){return s("option",{key:t.id,domProps:{value:t.id}},[e._v(" "+e._s(t.architecture)+" "+e._s(t.size)+" ")])}))],2)])},L=[],E={data:function(){return{distributionId:null,isReset:!1}},props:["item","taskCreated","panels","selected","panelId"],watch:{taskCreated:function(e){e?(this.distributionId=null,this.isReset=!0):this.isReset=!1},panelId:function(){var e=this;this.panels.forEach((function(t){t.distSelected||(e.distributionId=null)}))}}},S=E,D=Object(p["a"])(S,O,L,!1,null,null,null),B=D.exports,$={name:"app-table-module",data:function(){return{offset:0,optionSelected:!0,pages:[],basesIds:[],totalPages:0,limit:10,selected:!1,loading:!0,linkReadyBases:!0,progressVisible:!1,errorsObj:{WAITING:"Пакет добавлен в очередь на загрузку",IN_PROCESS:"Загрузка пакета программных продуктов",SUCCESS:"Загрузка завершена",FAILURE:"Ошибка создания архива"},disabledDownloadButton:!1,panels:[],panelId:null,licenseModulesIds:[]}},components:{preloader:v,selectDistribution:B,tableLicenses:C,selectCount:T},props:{archive:{type:Object,required:!0},distributionId:{required:!0},errorTextLimit:{type:String,required:!0},getLinks:{required:!0},taskCreated:{required:!0},panel:{required:!0},emptyTasks:{required:!0},emptyError:{required:!0}},computed:Object(c["a"])(Object(c["a"])({},Object(u["c"])(["getDataLicenses"])),{},{canNext:function(){return this.offset+1<this.totalPages},canPrev:function(){return this.offset>0}}),watch:{limit:function(e){this.selected&&(this.selected=!1),this.clearPages(),this.splitPages(),this.offset=0}},methods:Object(c["a"])(Object(c["a"])({},Object(u["b"])(["fetchLicenses"])),{},{changeSelectCount:function(e){this.$emit("select-count",e),this.limit=e.limit,this.offset=0,this.clearPages(),this.splitPages()},changePanel:function(e){this.$emit("change-panel",e,this.panels,this.licenseModulesIds),this.panelId=+e.target.parentElement.dataset.id,this.licenseModulesIds=[]},selectCheckbox:function(e){this.$emit("select-checkbox",e)},changeDistributionSelect:function(e){var t=this,s=this.panels.findIndex((function(e){return e.id===t.panelId}));this.panels[s].distSelected=!0,this.$emit("change-distribution",e,this.panels[s].distSelected)},splitPages:function(){this.totalPages=Math.ceil(this.getDataLicenses.length/this.limit);for(var e=0;e<this.totalPages;e++){var t=e*this.limit,s=t+this.limit;this.pages.push(this.getDataLicenses.slice(t,s))}},clearPages:function(){this.pages=[]},next:function(){this.canNext&&this.offset++},prev:function(){this.canPrev&&this.offset--},selectAll:function(e,t){var s=this;t=t.map((function(t){return t.checked=e.target.checked,t}));var a=this.panels.findIndex((function(e){return e.id===s.panelId}));e.target.checked?(this.panels[a].checkboxes=t,this.panels[a].checkboxes.forEach((function(e){s.licenseModulesIds.push(+e.value)}))):(w.resetCheckbox(this.panels[a].checkboxes),this.licenseModulesIds=[]),this.$emit("select-all",e,t)}}),mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchLicenses();case 2:return t.next=4,e.splitPages();case 4:null===(s=e.$refs.expPanel)||void 0===s||s.forEach((function(t){e.panels.push({id:t.$attrs["data-id"],checkboxes:[],status:!1,distSelected:!1})})),e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()}},R=$,M=Object(p["a"])(R,o,l,!1,null,null,null),N=M.exports,z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"tables-show",attrs:{id:"app-table-main"}},[s("div",{staticClass:"baseTableLimit__select",on:{click:function(e){e.stopPropagation()}}},[s("selectCount",{on:{"select-count":e.changeSelectCount}})],1),s("table",{attrs:{id:"mainTable"}},[s("thead",{on:{click:e.sortBases}},[s("tr",[s("th",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"selected"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.selected)?e._i(e.selected,null)>-1:e.selected},on:{change:[function(t){var s=e.selected,a=t.target,n=!!a.checked;if(Array.isArray(s)){var r=null,i=e._i(s,r);a.checked?i<0&&(e.selected=s.concat([r])):i>-1&&(e.selected=s.slice(0,i).concat(s.slice(i+1)))}else e.selected=n},function(t){e.$emit("select-all",t,e.selectAll(t))}]}})]),s("th",[e._v("№")]),s("th",[e._v("Наименование")]),s("th",{staticClass:"region",attrs:{"data-sort":"region"}},[e._v(" Регион "),s("img",{staticClass:"arrow-icon",style:[e.sortRegion?{transform:"rotate(180deg)"}:{transform:"rotate(0deg)"}],attrs:{src:"/templates/wizardsoft2/images/down-arrow.svg",alt:"",width:"9px",height:"9px"}})]),s("th",{staticClass:"dateTh",attrs:{"data-sort":"updatedat"}},[e._v(" Дата обновления "),s("img",{staticClass:"arrow-icon",style:[e.sortUpdatedAt?{transform:"rotate(180deg)"}:{transform:"rotate(0deg)"}],attrs:{width:"9px",height:"9px",src:"/templates/wizardsoft2/images/down-arrow.svg",alt:""}})]),s("th",{staticClass:"dateTh",attrs:{"data-sort":"updatedate"}},[e._v(" Дата выгрузки "),s("img",{staticClass:"arrow-icon",style:[e.sortUpdateDate?{transform:"rotate(180deg)"}:{transform:"rotate(0deg)"}],attrs:{width:"9px",height:"9px",src:"/templates/wizardsoft2/images/down-arrow.svg",alt:""}})]),s("th",[e._v("Размер")])])]),e.loading?s("tr",[s("td",{staticClass:"preloader-wrapper",attrs:{colspan:"7"}},[s("preloader")],1)]):s("tbody",e._l(e.pages[e.offset],(function(t,a){return s("tr",{key:t.id},[s("td",[s("input",{ref:"checkbox",refInFor:!0,attrs:{type:"checkbox","data-id":0===e.offset?a+1:e.limit*e.offset+(a+1)},domProps:{checked:e.checkboxIds.includes(t.id),value:t.id},on:{change:function(t){return e.$emit("select-checkbox",t)}}})]),s("td",[e._v(" "+e._s(0===e.offset?a+1:e.limit*e.offset+(a+1))+" ")]),s("td",[e._v(e._s(t.basename))]),s("td",[e._v(" "+e._s(t.region)+" ")]),s("td",[e._v(e._s(e._f("date")(t.updated_at,"datetime")))]),s("td",[e._v(e._s(e._f("date")(t.updatedate,"datetime")))]),s("td",[e._v(e._s(t.size))])])})),0)]),s("div",{staticClass:"but__wrapper"},[s("div",{staticClass:"but-download__info"},[s("button",{staticClass:"but_download",attrs:{disabled:e.archive.progress<100||e.getLinks.length>=5||e.emptyTasks},on:{click:function(t){return e.$emit("create-task")}}},[e._v(" Скачать выделенное ")]),e.archive.progress<100?s("span",{staticClass:"but-download__message"},[e._v(" Вы сможете повторить операцию, после загрузки текущего пакета ")]):e.getLinks.length>=5?s("span",{staticClass:"but-download__message"},[e._v(" "+e._s(e.errorTextLimit)+" ")]):e._e(),e.emptyTasks?s("span",{staticClass:"but-download__message"},[e._v(" "+e._s(e.emptyError)+" ")]):e._e()]),s("div",{staticClass:"but__controlls"},[s("button",{staticClass:"but_default_bg",staticStyle:{"margin-right":"20px"},attrs:{disabled:!e.canPrev},on:{click:e.prev}},[e._v(" Предыдущая ")]),s("button",{staticClass:"but_default_bg",attrs:{disabled:!e.canNext},on:{click:e.next}},[e._v(" Следующая ")])])])])])},U=[],q=(s("d3b7"),s("bf19"),{data:function(){return{offset:0,basesIds:[],pages:[],bases:[],checkboxSelected:[],totalPages:0,limit:10,selected:!1,optionSelected:!0,disabledDownloadButton:!1,counts:[10,25,50,100],progressVisible:!1,loading:!0,linkDeleteText:"",timeout:2e3,snackbar:!1,errorFetchBases:!1,sortUpdatedAt:!1,sortUpdateDate:!1,sortRegion:!1}},props:["checkboxIds","taskCreated","archive","errorTextLimit","getLinks","errorsObj","emptyError","emptyTasks","checkboxAllEl"],components:{preloader:v,selectCount:T},filters:{numberLimit:function(e){return+e}},methods:{sortedPages:function(e){return this.pages[this.offset].map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{updatedate:new Date(e.updatedate).getTime()})})).sort(e).map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{updatedate:new Date(e.updatedate).toJSON()})}))},sortBases:function(e){var t=null;switch(e.target.dataset.sort){case"updatedate":this.sortUpdateDate=!this.sortUpdateDate,this.sortRegion=!1,this.sortUpdatedAt=!1,this.sortUpdateDate?(t=this.sortedPages(w.sortedByAsc),this.$set(this.pages,this.offset,t)):(t=this.sortedPages(w.sortedByDesc),this.$set(this.pages,this.offset,t));break;case"updatedat":this.sortUpdatedAt=!this.sortUpdatedAt,this.sortRegion=!1,this.sortUpdateDate=!1,this.sortUpdatedAt?(t=this.sortedPages((function(e,t){return t.updated_at-e.updated_at})),this.$set(this.pages,this.offset,t)):(t=this.sortedPages((function(e,t){return e.updated_at-t.updated_at})),this.$set(this.pages,this.offset,t));break;case"region":this.sortRegion=!this.sortRegion,this.sortUpdatedAt=!1,this.sortUpdateDate=!1,this.sortRegion?(t=this.sortedPages((function(e,t){return e.region.localeCompare(t.region)})),this.$set(this.pages,this.offset,t)):(t=this.sortedPages((function(e,t){return t.region.localeCompare(e.region)})),this.$set(this.pages,this.offset,t));break}},changeSelectCount:function(e){this.$emit("select-count",e),this.limit=e.limit,this.offset=0,this.clearPages(),this.splitPages(),this.checkboxAllEl&&(this.checkboxAllEl.checked=!1)},next:function(){this.canNext&&(this.selected&&(this.selected=!1),this.offset++)},prev:function(){this.canPrev&&(this.selected&&(this.selected=!1),this.offset--)},clearPages:function(){this.pages=[],this.offset=0},splitPages:function(){this.totalPages=Math.ceil(this.dataBases.length/this.limit);for(var e=0;e<this.totalPages;e++){var t=e*this.limit,s=t+this.limit;this.pages.push(this.getDataBases.slice(t,s))}},selectAll:function(e){return this.$refs.checkbox.map((function(t){return t.checked=e.target.checked,t}))},selectCheckbox:function(){this.checkboxSelected=this.$refs.checkbox.filter((function(e){return e.checked}))}},watch:{getDataBases:function(e){this.clearPages(),this.splitPages()}},mounted:function(){var e=this;this.$store.dispatch("fetchDataBases").then((function(){e.splitPages()})).catch((function(t){console.log(t),console.log(e.errorFetchBases),e.$store.commit("setErrorGlobal",!0)})).finally((function(){e.loading=!1})),this.pages=this.pages.map((function(e){return e.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{updatedate:new Date(e.updatedate).getTime()})})).sort((function(e,t){return t.updatedate-e.updatedate})).map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{updatedate:new Date(e.updatedate).toJSON()})}))}))},computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(u["c"])(["getTotalPages","getDataBases"])),Object(u["d"])({dataBases:function(e){return e.appTable.base}})),{},{canNext:function(){return this.offset+1<this.totalPages},canPrev:function(){return this.offset>0}})}),F=q,V=Object(p["a"])(F,z,U,!1,null,null,null),G=V.exports,J=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"smetaWizard__controlls"},[e._l(e.products,(function(t){return s("button",{key:t.id,staticClass:"tableDatabase",class:{tableActive:t.isActive},attrs:{"data-type":t.id},on:{click:function(s){return e.tabChange(t)}}},[e._v(" Базы данных "+e._s(t.name)+" ")])})),s("button",{staticClass:"tableLicense",class:{tableActive:e.isActive},attrs:{"data-type":"lc"},on:{click:e.activeLicense}},[e._v(" Обновления ПП и лицензии к модулям ")])],2)},W=[],Z=(s("a9e3"),{data:function(){return{isActive:!1,products:[]}},methods:Object(c["a"])(Object(c["a"])({},Object(u["b"])(["fetchDataProducts"])),{},{activeLicense:function(e){this.isActive=!0,this.isActive&&(this.products=this.products.map((function(e){return e.isActive=!1,e}))),this.$emit("tab-active",e,this.isActive)},tabChange:function(e){var t=this.products.findIndex((function(t){return Number(t.id)===Number(e.id)}));this.products.forEach((function(e){return e.isActive=!1})),this.products[t].isActive=!0,this.isActive=!1,this.$emit("tab-change",e)}}),computed:Object(c["a"])(Object(c["a"])({},Object(u["d"])({typeProduct:function(e){return e.tabControls.typeProducts}})),Object(u["c"])(["getDataProducts"])),mounted:function(){var e=this;this.fetchDataProducts().then((function(t){t.map((function(t,s){e.products.push(Object(c["a"])(Object(c["a"])({},t),{},{isActive:!s}))})),t.length>=2?e.tabChange(e.products[1]):e.tabChange(e.products[0])}))}}),K=Z,Y=Object(p["a"])(K,J,W,!1,null,null,null),H=Y.exports,Q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return(e.archive.progress<100?e.progressVisible=!0:e.progressVisible=!1)?s("div",{staticClass:"progress-wrapper"},[s("v-app",{staticClass:"progress-line"},[s("v-progress-linear",{staticClass:"hiddenProgress progress-bar",class:{showProgress:e.archive.progress<100},attrs:{color:"blue darken-1",height:"25",value:e.archive.progress}},[s("strong",{staticClass:"white--text"},[e._v(e._s(e.archive.progress||0)+"%")])])],1),s("v-alert",{staticClass:"hiddenProgress progress-alert ma-0",class:{showProgress:e.archive.progress<100}},[e._v(e._s(e.loadingStatus[e.archive.status]))])],1):e._e()},X=[],ee={data:function(){return{typeTask:""}},props:{archive:{type:Object,required:!0}},computed:{loadingStatus:function(){return{WAITING:"Пакет добавлен в очередь на загрузку",IN_PROCESS:"bases"===this.typeTask?"Загрузка пакета баз данных":"Загрузка пакета программных продуктов",SUCCESS:"Загрузка завершена",FAILURE:"Ошибка создания архива"}}},watch:{archive:function(){this.typeTask=this.archive.type_task}}},te=ee,se=Object(p["a"])(te,Q,X,!1,null,null,null),ae=se.exports,ne=function(){var e=this,t=e.$createElement,s=e._self._c||t;return 100===e.archive.progress&&e.taskCreated||e.getLinks.length&&!e.taskCreated?s("div",{staticClass:"link-box__wrapper"},[e._l(e.getArchives,(function(t,a){return s("div",{key:e.getLinks[a],staticClass:"link-box"},[s("span",{staticClass:"mr-3 link-box__text"},[e._v("Скачать ")]),"bases"===t.type_task?s("a",{staticClass:"mr-3 link-box__link",attrs:{target:"_blank",href:e.getLinks[a]}},[e._v("пакеты баз данных "+e._s(e._f("date")(t.created_at,"time"))+" "+e._s(e._f("fileSize")(t.size)))]):s("a",{staticClass:"mr-3 link-box__link",attrs:{target:"_blank",href:e.getLinks[a]}},[e._v("пакеты программных продуктов "+e._s(e._f("date")(t.created_at,"time"))+" "+e._s(e._f("fileSize")(t.size)))]),s("button",{staticClass:"but-delete",attrs:{"data-id":t.id,"data-delete":"true"},on:{click:e.deleteLink}},[s("span",[e._v("×")])])])})),s("v-snackbar",{attrs:{timeout:e.timeout},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.attrs;return[s("v-btn",e._b({staticStyle:{"font-size":"1.3rem"},attrs:{color:"blue",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",a,!1),[e._v(" × ")])]}}],null,!1,2961412421),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.linkDeleteText)+" ")])],2):e._e()},re=[],ie={data:function(){return{linkDeleteText:"",timeout:2e3,snackbar:!1}},props:{archive:{type:Object,required:!0},taskCreated:{type:Boolean,required:!0},getLinks:{required:!0},getArchives:{required:!0}},methods:{deleteLink:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var a,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(a=e.target,!a.dataset.delete){s.next=8;break}return n=+a.dataset.id,s.next=5,t.$store.dispatch("deleteArchive",n);case 5:return s.next=7,t.$store.dispatch("fetchArchives");case 7:t.snackbar=!0;case 8:t.linkDeleteText="Архив успешно удалён!";case 9:case"end":return s.stop()}}),s)})))()}}},ce=ie,oe=Object(p["a"])(ce,ne,re,!1,null,null,null),le=oe.exports,ue=(s("99af"),{state:{base:[]},mutations:{setBase:function(e,t){e.base=t}},actions:{fetchDataBases:function(e,t){var s=e.rootState.code,a="https://update.wizardsoft.ru/api/serial/".concat(s,"/product/1/bases/");return fetch(t?"https://update.wizardsoft.ru".concat(t):a).then((function(e){return 200===e.status?e.json():Promise.reject()})).then((function(t){return e.commit("setBase",t),basesBridge.newBasesExists=!0,t})).catch((function(t){basesBridge.newBasesExists=!1,e.commit("setErrorGlobal",t||!0)}))}},getters:{getDataBases:function(e){return e.base}}}),de={state:{dataLicenses:[]},mutations:{setLicense:function(e,t){e.dataLicenses=t}},actions:{fetchLicenses:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=e.commit,a=e.rootState,t.abrupt("return",fetch(" https://update.wizardsoft.ru/api/serial/".concat(a.code,"/product/1/product_versions/")).then((function(e){return 200===e.status?e.json():Promise.reject()})).then((function(e){return s("setLicense",e)})).catch((function(e){return s("setErrorGlobal",e||!0,{root:!0})})));case 2:case"end":return t.stop()}}),t)})))()}},getters:{getDataLicenses:function(e){return e.dataLicenses}}},he=s("d4ec"),pe=s("262e"),fe=s("2caf"),be=s("9072"),ve=function(e){Object(pe["a"])(s,e);var t=Object(fe["a"])(s);function s(){return Object(he["a"])(this,s),t.apply(this,arguments)}return s}(Object(be["a"])(Error)),ge={state:{typeProducts:[]},mutations:{setProduct:function(e,t){e.typeProducts=t}},actions:{fetchDataProducts:function(e){var t=e.rootState.code;return fetch("https://update.wizardsoft.ru/api/serial/".concat(t,"/products/")).then((function(e){if(basesBridge.newBasesExists=200===e.status,200===e.status)return e.json();throw new ve("Bad response from server")})).then((function(t){return e.commit("setProduct",t),t})).catch((function(e){return e instanceof ve?[]:Promise.reject(e)}))}},getters:{getDataProducts:function(e){return e.typeProducts}}};a["default"].use(u["a"]);var ke="WS001",me=new u["a"].Store({state:{archive:{},archiveTasks:{},archives:[],link:"#",links:[],messageError:"",errorGlobal:!1,code:void 0},mutations:{setCode:function(e,t){e.code=String(t)},setErrorGlobal:function(e,t){e.errorGlobal=t},setArchiveTasks:function(e,t){e.archiveTasks=t},setArchive:function(e,t){e.archive=t},setArchives:function(e,t){e.archives=t},createLinks:function(e,t){if(Array.isArray(t))e.links=t.map((function(e){return"https://update.wizardsoft.ru/api/serial/".concat(e.code,"/archives/").concat(e.id,"/download/")}));else{var s="https://update.wizardsoft.ru/api/serial/".concat(t.code,"/archives/").concat(t.id,"/download/");!e.links.includes(s)&&e.links.push(s)}},setMessageError:function(e,t){e.messageError=t}},actions:{applicationInit:function(e,t){var s=t.code,a=void 0===s?void 0:s;e.commit("setCode",a)},fetchArchiveTasks:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function s(){var a,n,r,c,o,l;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.commit,a=e.getters,n=e.dispatch,r=e.state,s.prev=1,s.next=4,fetch("https://update.wizardsoft.ru/api/serial/".concat(r.code,"/archives/"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t)});case 4:return c=s.sent,s.next=7,c.json();case 7:if(o=s.sent,c.ok){s.next=10;break}throw o;case 10:return s.next=12,n("fetchArchive",o.id);case 12:l=setInterval(Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n("fetchArchive",o.id);case 2:return e.next=4,n("fetchArchives");case 4:100===a.archive.progress&&clearInterval(l);case 5:case"end":return e.stop()}}),e)}))),1e3),s.next=18;break;case 15:s.prev=15,s.t0=s["catch"](1),console.log(s.t0);case 18:case"end":return s.stop()}}),s,null,[[1,15]])})))()},fetchArchive:function(e){var t=arguments;return Object(i["a"])(regeneratorRuntime.mark((function s(){var a,n,r,i,c,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return a=e.commit,n=e.state,r=t.length>1&&void 0!==t[1]?t[1]:"",console.log(n.code),s.prev=3,s.next=6,fetch("https://update.wizardsoft.ru/api/serial/".concat(n.code,"/archives/").concat(r,"/"));case 6:return i=s.sent,s.next=9,i.json();case 9:c=s.sent,o={code:n.code,id:c.id},a("setArchive",c),a("createLinks",o),s.next=18;break;case 15:throw s.prev=15,s.t0=s["catch"](3),new Error(s.t0);case 18:case"end":return s.stop()}}),s,null,[[3,15]])})))()},fetchArchives:function(e){var t=e.commit,s=e.state;fetch("https://update.wizardsoft.ru/api/serial/".concat(s.code,"/archives/")).then((function(e){return 200==e.status?e.json():[]})).then((function(e){t("createLinks",e.map((function(e){return{code:s.code,id:e.id}}))),t("setArchives",e)})).catch((function(e){return console.info(e)}))},deleteArchive:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.commit,a=e.state,s.prev=1,s.next=4,fetch("https://update.wizardsoft.ru/api/serial/".concat(a.code,"/archives/").concat(t,"/"),{method:"DELETE",mode:"cors"});case 4:s.sent,s.next=10;break;case 7:throw s.prev=7,s.t0=s["catch"](1),new Error(s.t0);case 10:case"end":return s.stop()}}),s,null,[[1,7]])})))()}},getters:{getArchiveTasks:function(e){return e.archiveTasks},archive:function(e){return e.archive},waitingTask:function(e){return e.waitingTask},getLink:function(e){return e.link},getArchives:function(e){return e.archives},getLinks:function(e){return e.links},getMessageError:function(e){return e.messageError}},modules:{appTable:ue,appTableModule:de,tabControls:ge}}),xe={name:"App",data:function(){return{tabBaseIsActive:!1,tabLicenseIsActive:!1,checkboxIds:[],selectedCheckbox:[],checkboxAllEl:"",taskCreated:!1,distributionId:null,emptyError:"",emptyTasks:!1,errorTextLimit:"Вы не можете хранить больше 5 ссылок одновременно. Для загрузки удалите ссылку",licenseTaskData:{},panel:{},licModIds:[],panelId:null,panels:[],ready:!1}},components:{appTableModule:N,tabControls:H,appTable:G,SelectCount:T,Progressbar:ae,Links:le},methods:Object(c["a"])(Object(c["a"])({},Object(u["b"])(["fetchDataBases","fetchArchives","fetchArchiveTasks","fetchDataProducts","applicationInit"])),{},{tabChange:function(e){console.log(e),this.tabBaseIsActive=e.isActive,this.tabLicenseIsActive=!1,this.fetchDataBases(e.links.bases).then((function(){})),console.log("меняю таб")},changePanel:function(e,t,s){var a=this;this.panelId=+e.target.parentElement.dataset.id,this.panels=t,t.forEach((function(e){a.panelId===e.id?(e.status=!e.status,e.current=!0,a.panel=e,a.checkboxIds=s):(e.current=!1,e.current||(e.status=!1,a.emptyTasks=!1,e.distSelected&&(a.distributionId=null,e.distSelected=!1),e.checkboxes.length&&(w.resetCheckbox(e.checkboxes),w.resetCheckboxAll(a.checkboxAllEl),a.checkboxIds.splice())))}))},changeSelectCount:function(e){var t=this;e.selectedValue&&(this.selectedCheckbox.forEach((function(e,s){+e.value===t.checkboxIds[s]&&e.checked&&(e.checked=!1)})),this.checkboxIds=[],this.selectedCheckbox=[])},checkboxSelectAll:function(e,t){this.checkboxAllEl=e.target,this.checkboxAllEl.checked?(this.selectedCheckbox=t.filter((function(e){return e.checked})),this.selectedCheckbox.length&&(this.checkboxIds=this.selectedCheckbox.map((function(e){return+e.value}))),this.emptyTasks=!1):(w.resetCheckbox(this.selectedCheckbox),this.checkboxIds.splice(0))},checkboxCheck:function(e){var t=e.target;if(!this.checkboxIds.includes(+t.value)&&t.checked)this.checkboxIds.push(+t.value),this.selectedCheckbox.push(t),this.panelId&&(this.panel.checkboxes=this.selectedCheckbox),this.emptyTasks=!1;else{var s=this.checkboxIds.findIndex((function(e){return e===+t.value})),a=this.selectedCheckbox.findIndex((function(e){return+e.value===+t.value}));this.checkboxIds.splice(s,1),this.selectedCheckbox.splice(a,1)}},tabActive:function(e,t){console.log(t),this.tabBaseIsActive=!1,this.tabLicenseIsActive=!0,this.resetData()},resetData:function(){this.checkboxIds=[],w.resetCheckboxAll(this.checkboxAllEl),this.selectedCheckbox=[],this.panel.checkboxes=[],this.distributionId=null,this.panel.distSelected=!1,this.panel.status=!1,this.panel.current=!1,this.emptyTasks=!1},setDistributionId:function(e){this.distributionId=e},downloadFile:function(e,t){var s=document.createElement("a");return s.href=e,s.setAttribute("download",t),s.setAttribute("target","_blank"),s.dataset.link="",s.style.display="none",s.click(),!1},createTasks:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s={type_task:"bases",data:{bases_ids:e.checkboxIds}},5===e.getArchives.length){t.next=11;break}if(e.checkboxIds.length){t.next=6;break}return e.emptyError="Для скачивания, выберите хотя бы один элемент",e.emptyTasks=!0,t.abrupt("return");case 6:return t.next=8,e.saveBaseTask(s);case 8:a=setInterval((function(){if(100===e.archive.progress){var t=e.getLinks[e.getLinks.length-1];e.downloadFile(t,e.archive.archive_name),clearTimeout(a)}}),1e3),t.next=14;break;case 11:e.errorTextLimit="Нельзя создать больше пяти задач от серийного номера.",w.resetCheckbox(e.selectedCheckbox),w.resetCheckboxAll(e.checkboxAllEl);case 14:case"end":return t.stop()}}),t)})))()},saveBaseTask:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,t.fetchArchiveTasks(e);case 2:return s.next=4,w.resetCheckbox(t.selectedCheckbox);case 4:w.resetCheckboxAll(t.checkboxAllEl),t.taskCreated=!0,t.checkboxIds=[];case 7:case"end":return s.stop()}}),s)})))()},saveLicense:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,t.fetchArchiveTasks(e);case 2:return s.next=4,w.resetCheckbox(t.selectedCheckbox);case 4:w.resetCheckboxAll(t.checkboxAllEl),w.resetCheckbox(t.panel.checkboxes),t.taskCreated=!0,t.panel.distSelected=!1,t.checkboxIds=[],t.selectedCheckbox=[];case 10:case"end":return s.stop()}}),s)})))()},createLicenseTask:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a,n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s={type_task:"product",data:{distribution:e.distributionId,modules_licenses:e.checkboxIds}},5===e.getArchives.length){t.next=36;break}if("number"!==typeof e.distributionId||!s.data.modules_licenses.length){t.next=9;break}return t.next=5,e.saveLicense(s);case 5:a=setInterval((function(){if(100===e.archive.progress){var t=e.getLinks[e.getLinks.length-1];e.downloadFile(t,e.archive.archive_name),e.distributionId=null,e.taskCreated=!1,clearTimeout(a)}}),1e3),s={},t.next=34;break;case 9:if("number"!==typeof e.distributionId||s.data.modules_licenses.length){t.next=21;break}return s.data.distribution=e.distributionId,t.next=13,e.fetchArchiveTasks(s);case 13:return t.next=15,e.fetchArchives();case 15:e.taskCreated=!0,e.panel.distSelected=!1,s={},n=setInterval((function(){if(100===e.archive.progress){var t=e.getLinks[e.getLinks.length-1];e.downloadFile(t,e.archive.archive_name),e.distributionId=null,e.taskCreated=!1,clearTimeout(n)}}),1e3),t.next=34;break;case 21:if(!isNaN(e.distributionId)&&e.distributionId||!e.checkboxIds.length){t.next=32;break}return r={modules_licenses:e.checkboxIds},s.data=r,delete s.distribution,t.next=27,e.saveLicense(s);case 27:i=setInterval((function(){if(100===e.archive.progress){var t=e.getLinks[e.getLinks.length-1];e.downloadFile(t,e.archive.archive_name),console.log("я скачал хуйню"),e.distributionId=null,e.taskCreated=!1,e.selectedCheckbox=[],e.panel.checkboxes=[],clearTimeout(i)}}),1e3),e.emptyTasks=!1,s={},t.next=34;break;case 32:e.emptyTasks=!0,e.emptyError="Выберите хотя бы один элемент";case 34:t.next=39;break;case 36:e.errorTextLimit="Нельзя создать больше пяти задач от серийного номера.",w.resetCheckbox(e.selectedCheckbox),w.resetCheckboxAll(e.checkboxAllEl);case 39:case"end":return t.stop()}}),t)})))()}}),mounted:function(){var e,t,s=this;this.applicationInit({code:encodeURIComponent((null===(e=document.querySelector("#snb_update_options"))||void 0===e||null===(t=e.dataset)||void 0===t?void 0:t.code)||ke)}).then((function(){return s.fetchArchives()})).then((function(){return s.ready=!0}))},computed:Object(c["a"])(Object(c["a"])({},Object(u["d"])(["errorGlobal"])),Object(u["c"])(["archive","getLinks","getArchives","getMessageError"]))},_e=xe,Ce=(s("5c0b"),Object(p["a"])(_e,n,r,!1,null,null,null)),we=Ce.exports,ye=s("ce5b"),Ae=s.n(ye),Ie=(s("bf40"),s("9483"));function je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"date",s={};return t.includes("date")&&(s.day="2-digit",s.month="2-digit",s.year="numeric"),t.includes("time")&&(s.hour="2-digit",s.minute="2-digit"),new Intl.DateTimeFormat("ru-RU",s).format(new Date(e))}function Pe(e){var t=1024,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];if(!e)return"0 Byte";var a=+Math.floor(Math.log(e)/Math.log(t));return Math.round(e/Math.pow(t,a))+" "+s[a]}Object(Ie["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),a["default"].config.productionTip=!1,a["default"].use(Ae.a),a["default"].filter("date",je),a["default"].filter("fileSize",Pe),new a["default"]({store:me,vuetify:new Ae.a,render:function(e){return e(we)}}).$mount("#app")},"5c0b":function(e,t,s){"use strict";s("9c0c")},"9c0c":function(e,t,s){}});
//# sourceMappingURL=app.f26b0152.js.map